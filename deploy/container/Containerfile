FROM alpine:latest

ARG APP_LOCATION=/app
ARG GPG_PUBLICKEY=backup-to-cloud_publickey.asc
ARG USERNAME=btc
ARG UID=1000
ARG GID=2000

RUN apk --no-cache add \
  bash \
  curl \
  gnupg \
  shadow


RUN adduser -D -u $UID $USERNAME

RUN mkdir $APP_LOCATION

WORKDIR $APP_LOCATION

COPY /src .

RUN chown -R $UID:$GID $APP_LOCATION

USER $USERNAME

# Import the GPG public key
RUN gpg --import $APP_LOCATION/$GPG_PUBLICKEY

CMD ["/bin/bash"]
